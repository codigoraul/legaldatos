---
export type BreadcrumbItem = {
	label: string;
	href?: string;
};

const {
	title,
	backgroundImage,
	backgroundPosition,
	breadcrumbs = [],
} = Astro.props as {
	title: string;
	backgroundImage?: string;
	backgroundPosition?: string;
	breadcrumbs?: BreadcrumbItem[];
};

const items = Array.isArray(breadcrumbs) ? breadcrumbs : [];
const effectiveBgImage = typeof backgroundImage === 'string' && backgroundImage.length > 0 ? backgroundImage : '/bg-title.jpg';
const hasBackgroundImage = true;
const position =
	typeof backgroundPosition === 'string' && backgroundPosition.length > 0 ? backgroundPosition : '60% 39%';
---

<section
	class={`titlebar ${hasBackgroundImage ? 'has-image' : ''}`}
	style={
		hasBackgroundImage
			? { '--tb-bg-image': `url('${effectiveBgImage}')`, '--tb-bg-position': position }
			: undefined
	}
>
	<div class="container">
		<h2 class="title">{title}</h2>
		<nav class="breadcrumb" aria-label="Breadcrumb">
			<ol>
				{items.map((item, index) => (
					<li>
						{item?.href ? (
							<a href={item.href}>{item.label}</a>
						) : (
							<span aria-current={index === items.length - 1 ? 'page' : undefined}>{item?.label}</span>
						)}
						{index < items.length - 1 && <span class="sep">/</span>}
					</li>
				))}
			</ol>
		</nav>
	</div>
</section>

<style>
	.titlebar {
		--eq-background: var(--surface);
		--eq-border: var(--border);
		--eq-text: var(--text);
		--eq-text-muted: var(--muted);
		--eq-primary: var(--primary);

		background: var(--eq-background);
		padding: 4.1rem 0 3rem;
		border-bottom: 1px solid var(--eq-border);
		position: relative;
		overflow: hidden;
	}

	.titlebar.has-image {
		background-image:
			linear-gradient(135deg, rgba(15, 29, 62, 0.74) 0%, rgba(15, 29, 62, 0.54) 100%),
			var(--tb-bg-image);
		background-size: cover;
		background-position: var(--tb-bg-position);
		border-bottom-color: rgba(255, 255, 255, 0.12);
	}

	.titlebar.has-image::before {
		content: '';
		position: absolute;
		inset: 0;
		background: rgba(0, 0, 0, 0.04);
		pointer-events: none;
	}

	.container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 2rem;
		position: relative;
	}

	.title {
		margin: 0 0 0.65rem;
		color: var(--eq-text);
		font-size: 34px;
		letter-spacing: -0.02em;
		line-height: 1.15;
		font-weight: 700;
	}

	.titlebar.has-image .title {
		color: rgba(255, 255, 255, 0.98);
		text-shadow: 0 2px 14px rgba(0, 0, 0, 0.35);
	}

	.breadcrumb ol {
		margin: 0;
		padding: 0;
		list-style: none;
		display: flex;
		flex-wrap: wrap;
		align-items: center;
		gap: 0.5rem;
		color: var(--eq-text-muted);
		font-size: 0.9rem;
	}

	.titlebar.has-image .breadcrumb ol {
		color: rgba(255, 255, 255, 0.82);
	}

	.breadcrumb a {
		color: var(--eq-primary);
		text-decoration: none;
		font-weight: 600;
	}

	.titlebar.has-image .breadcrumb a {
		color: rgba(255, 255, 255, 0.92);
	}

	.breadcrumb a:hover {
		text-decoration: underline;
	}

	.sep {
		opacity: 0.6;
	}

	@media (max-width: 768px) {
		.titlebar {
			padding: 3.4rem 0 2.4rem;
		}

		.title {
			font-size: 28px;
		}

		.container {
			padding: 0 1.5rem;
		}
	}
</style>
